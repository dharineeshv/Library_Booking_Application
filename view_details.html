<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slot Details</title>
    <script src="https://kit.fontawesome.com/6045d1d2eb.js" crossorigin="anonymous"></script>
      <link rel="icon" href="Fav-icon.png" type="image/x-icon">
  <link rel="icon" type="image/png" href="Fav-icon.png">
</head>

<body>
    <div class="nav-container">
        <i class="fa-solid fa-arrow-left" id="left-arrow"></i>
        <h3>Slot Details</h3>
    </div>

    <div class="details-card">
       

        <div class="details">
          

        </div>
            
        
    </div>

</body>
</html>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');

* {
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body {
  background:#f7f9fc;
  font-family:'Poppins', sans-serif;
  padding:20px;
}

/* Top Nav */
.nav-container {
  display:flex;
  align-items:center;
  gap:20px;
  padding:15px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 2px 4px rgba(0,0,0,0.1);
  margin-bottom:20px;
}

.nav-container i {
  font-size:20px;
  cursor:pointer;
}

/* Card */
.details-card {
  width:100%;
  background:#fff;
  padding:12px;
  border-radius:15px;
  display:flex;
  gap:2px;
  align-items:center;
  box-shadow:0 4px 8px rgba(0,0,0,0.07);
}
    /* Mobile Responsive Fix */
@media (max-width: 480px) {
  
  .details-card[data-dynamic="true"] {
    width: 100%;
    padding: 12px;
    gap: 10px;
  }

  .profile-icon {
    width: 40px;
    height: 40px;
    font-size: 18px;
  }

  .details {
    width: 100%;
  }

  .inner-detail {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: nowrap;
  }

  .inner-detail h4 {
    width: 70px; /* Reduced for mobile */
    font-size: 13px;
  }

  .inner-detail p {
    font-size: 13px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; 
    max-width: 180px; /* Controls Email length */
  }
}

/* üìå Tablet Screens */
@media (max-width: 768px) {
  body {
    padding: 15px;
  }

  .details-card[data-dynamic="true"] {
    flex-direction: row;
    gap: 10px;
    padding: 12px;
  }

  .profile-icon {
    width: 50px;
    height: 50px;
    font-size: 22px;
  }

  .inner-detail h4 {
    width: 95px;
    font-size: 14px;
  }

  .inner-detail p {
    font-size: 14px;
  }
}

/* üìå Mobile Screens */
@media (max-width: 480px) {
  .details-card {
    width: 100%;
    gap: 12px;
    padding: 15px;
  }

  .profile-icon {
    width: 42px;
    height: 42px;
    font-size: 18px;
  }

  .details {
    width: 100%;
  }

  .inner-detail {
    flex-direction: row !important; /* ‚ùå do not stack */
    flex-wrap: nowrap;              /* ‚ùå prevent wrapping */
    gap: 10px;
    align-items: center;
  }

  .inner-detail h4 {
    width: 95px; /* force same line */
    font-size: 14px;
    text-align: right;
  }

  .inner-detail p {
    font-size: 13px;
    margin-left: 0;
    white-space: nowrap; /* ‚ùå prevent email from going to next line */
    overflow: hidden;
    text-overflow: ellipsis; /* adds ... if too long */
  }
}

/* Left Icon */
.profile-icon {
  width:60px;
  height:60px;
  background:#e0e7ff;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:30px;
  color:#4f46e5;
}
    .details-card[data-dynamic="true"] {
    margin-bottom: 18px; /* space between cards */
}

.details-card[data-dynamic="true"] {
    margin-bottom: 18px;
    padding: 15px;
    border-radius: 12px;
    background: #fff;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}
/* üìå Extra Small Devices */


/* Right Details */
.details {
  display:flex;
  flex-direction:column;
  gap:6px;
}

.inner-detail {
  display: flex;
  gap: 15px;
  align-items: center;
}
hr {
  border: none;
  border-top: 1px solid #ccc;
  margin: 10px 0;
  width: calc(100% + 24px); /* expand to full width */
  margin-left: -12px;       /* align left edge */
}



.inner-detail h4 {
  width: 110px; /* Increased width for perfect alignment */
  text-align: right; /* Makes it look clean */
  font-weight: 600;
}

.inner-detail p {
  font-size: 15px;
  margin-left: 10px;
}

</style>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

const appSetting = {
  databaseURL: "https://library-slot-booking-8ef25-default-rtdb.firebaseio.com/",
};
const app = initializeApp(appSetting);
const database = getDatabase(app);

const student_otp_db = ref(database, "Bookings");

// Read session storage
let stored = sessionStorage.getItem("view_datas");
let datas = JSON.parse(stored);
console.log(datas);

// MAIN LOGIC
onValue(student_otp_db, (snapshot) => {
    const container = document.querySelector("body"); // or any wrapper you want
    const oldCards = document.querySelectorAll(".details-card[data-dynamic='true']");
    oldCards.forEach(card => card.remove()); // remove old dynamic cards

    if (!snapshot.exists()) {
        console.log("No data found");
        return;
    }

    let found = false;
    const dbData = snapshot.val();

    for (let key in dbData) {
        let slot = dbData[key];

        if (
            slot.venue === datas.venue_name &&
            slot.date === datas.date &&
            slot.start_time === datas.time
        ) {
            found = true;

            // NEW details-card for each student
            let card = document.createElement("div");
            card.classList.add("details-card");
            card.setAttribute("data-dynamic", "true");
            card.style.justifyContent = "flex-start";

            let icon = document.createElement("div");
            icon.classList.add("profile-icon");
            icon.innerHTML = `<i class="fa-regular fa-user"></i>`;
            card.appendChild(icon);

            let details = document.createElement("div");
            details.classList.add("details");
            let email = slot.student_email;
       let username = email.split("@")[0].split(".")[0].toUpperCase();


            const fields = [
                { label: "Name:", value: username || "Unknown" },
                { label: "Email:", value: slot.student_email },
                { label: "Venue:", value: slot.venue }
            ];

            fields.forEach(data => {
                let row = document.createElement("div");
                row.classList.add("inner-detail");
                row.innerHTML = `<h4>${data.label}</h4><p>${data.value}</p>`;
                details.appendChild(row);
            });

            card.appendChild(details);
            container.appendChild(card);
        }
    }

    if (!found) {
        alert("No matching slot found.");
    }
});
    let back = document.querySelector('#left-arrow');
back.addEventListener('click',()=>
{
    window.location.href = "admin_dashboard.html";
})

</script>
