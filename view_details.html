<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slot Details</title>
    <script src="https://kit.fontawesome.com/6045d1d2eb.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="nav-container">
        <i class="fa-solid fa-arrow-left"></i>
        <h3>Slot Details</h3>
    </div>

    <div class="details-card">
       

        <div class="details">
          

        </div>
            
        
    </div>

</body>
</html>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');

* {
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body {
  background:#f7f9fc;
  font-family:'Poppins', sans-serif;
  padding:20px;
}

/* Top Nav */
.nav-container {
  display:flex;
  align-items:center;
  gap:20px;
  padding:15px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 2px 4px rgba(0,0,0,0.1);
  margin-bottom:20px;
}

.nav-container i {
  font-size:20px;
  cursor:pointer;
}

/* Card */
.details-card {
  width:100%;
  background:#fff;
  padding:12px;
  border-radius:15px;
  display:flex;
  gap:2px;
  align-items:center;
  box-shadow:0 4px 8px rgba(0,0,0,0.07);
}

/* Left Icon */
.profile-icon {
  width:60px;
  height:60px;
  background:#e0e7ff;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:30px;
  color:#4f46e5;
}

/* Right Details */
.details {
  display:flex;
  flex-direction:column;
  gap:6px;
}

.inner-detail {
  display: flex;
  gap: 15px;
  align-items: center;
}
hr {
  border: none;
  border-top: 1px solid #ccc;
  margin: 10px 0;
  width: 80%; /* to align with slot cards width */
}


.inner-detail h4 {
  width: 110px; /* Increased width for perfect alignment */
  text-align: right; /* Makes it look clean */
  font-weight: 600;
}

.inner-detail p {
  font-size: 15px;
  margin-left: 10px;
}

</style>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

const appSetting = {
  databaseURL: "https://library-slot-booking-8ef25-default-rtdb.firebaseio.com/",
};
const app = initializeApp(appSetting);
const database = getDatabase(app);

const student_otp_db = ref(database, "Bookings");

// Read session storage
let stored = sessionStorage.getItem("view_datas");
let datas = JSON.parse(stored);
console.log(datas);

// MAIN LOGIC
onValue(student_otp_db, (snapshot) => {
    if (!snapshot.exists()) {
        console.log("No data found");
        return;
    }

  const detailsDiv = document.querySelector(".details");
detailsDiv.innerHTML = ""; // clear previous results

let found = false;
const dbData = snapshot.val();

for (let key in dbData) {
    let slot = dbData[key];

    if (
        slot.venue === datas.venue_name &&
        slot.date === datas.date &&
        slot.start_time === datas.time
    ) {
        found = true;

        // Create a container div for this slot's details and icon
        let slotCard = document.createElement("div");
        slotCard.classList.add("slot-card");
        slotCard.style.display = "flex";
        slotCard.style.gap = "15px";
        slotCard.style.alignItems = "center";
        slotCard.style.marginBottom = "15px";
        slotCard.style.padding = "10px";
       
        slotCard.style.borderRadius = "10px";
        
       

        // Create profile icon div
        let icon = document.createElement("div");
        icon.classList.add("profile-icon");
        icon.innerHTML = `<i class="fa-regular fa-user"></i>`;
        slotCard.appendChild(icon);

        // Create details container
        let detailsContainer = document.createElement("div");
        detailsContainer.style.display = "flex";
        detailsContainer.style.flexDirection = "column";
        detailsContainer.style.gap = "6px";

        // Append fields: Name, Email, Venue
        const fields = [
            { label: "Name:", value: slot.student_name || "Unknown" },
            { label: "Email:", value: slot.student_email },
            { label: "Venue:", value: slot.venue }
        ];

        fields.forEach(({ label, value }) => {
            let div = document.createElement("div");
            div.classList.add("inner-detail");
            div.style.display = "flex";
            div.style.gap = "15px";
            div.style.alignItems = "center";

            let h4 = document.createElement("h4");
            h4.style.width = "110px";
            h4.style.textAlign = "right";
            h4.style.fontWeight = "600";
            h4.textContent = label;

            let p = document.createElement("p");
            p.style.fontSize = "15px";
            p.style.marginLeft = "10px";
            p.textContent = value;

            div.appendChild(h4);
            div.appendChild(p);
            detailsContainer.appendChild(div);
        });

        slotCard.appendChild(detailsContainer);
        

        let hr = document.createElement("hr");
        detailsDiv.appendChild(slotCard);
        document.querySelector(".details-card").appendChild(hr);



    }
}

if (!found) {
    detailsDiv.innerHTML = "<p>No matching slot found.</p>";
}

});
</script>
