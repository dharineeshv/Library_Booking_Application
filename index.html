<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Slot Booking Application - Login Form</title>
<link rel="icon" type="image/png" href="/Fav-icon.png">

<script src="https://kit.fontawesome.com/6045d1d2eb.js" crossorigin="anonymous"></script>
<script src="https://accounts.google.com/gsi/client" async defer></script>

<style>
@import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap");

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body{
  font-family:"Poppins",sans-serif;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  background:linear-gradient(-45deg,#4e73df,#1cc88a,#36b9cc,#224abe);
  background-size:400% 400%;
  animation:gradientBG 10s ease infinite;
}

/* Animated Background */
@keyframes gradientBG{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

/* Header */
.container-1{
  text-align:center;
  color:white;
  margin-bottom:30px;
  animation:fadeDown 0.8s ease;
}

.fa-solid.fa-graduation-cap{
  font-size:55px;
  margin-bottom:10px;
}

h1{
  font-size:28px;
  font-weight:600;
}

h2{
  font-weight:300;
  font-size:15px;
  opacity:0.9;
}

/* Glass Login Card */
.login-container{
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(20px);
  padding:40px 35px;
  border-radius:20px;
  width:380px;
  max-width:95vw;
  box-shadow:0 20px 40px rgba(0,0,0,0.25);
  animation:fadeUp 0.8s ease;
}

/* Form Group */
.form-group{
  position:relative;
  margin-bottom:25px;
}

input{
  width:100%;
  padding:14px 14px;
  border:none;
  border-radius:12px;
  font-size:14px;
  outline:none;
  background:rgba(255,255,255,0.9);
  transition:0.3s;
}

input:focus{
  transform:scale(1.02);
  box-shadow:0 0 0 3px rgba(255,255,255,0.5);
}

label{
  position:absolute;
  top:-8px;
  left:12px;
  background:white;
  padding:2px 8px;
  font-size:12px;
  font-weight:500;
  border-radius:6px;
  color:#4e73df;
}

/* Login Button */
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  color:white;
  background:linear-gradient(45deg,#4e73df,#224abe);
  transition:all 0.3s ease;
}

button:hover{
  transform:translateY(-3px);
  box-shadow:0 12px 20px rgba(0,0,0,0.3);
}

/* Divider */
#a{
  display:flex;
  align-items:center;
  margin:25px 0;
}

#b,#d{
  flex:1;
  height:1px;
  background:rgba(255,255,255,0.7);
}

#c p{
  margin:0 10px;
  color:white;
  font-size:13px;
}

/* Google Signin Fix */
#g_id_signin{
  display:flex;
  justify-content:center;
}

/* Animations */
@keyframes fadeUp{
  from{opacity:0;transform:translateY(30px);}
  to{opacity:1;transform:translateY(0);}
}

@keyframes fadeDown{
  from{opacity:0;transform:translateY(-30px);}
  to{opacity:1;transform:translateY(0);}
}

/* Responsive */
@media(max-width:480px){
  .login-container{
    padding:30px 20px;
  }
  h1{font-size:22px;}
  h2{font-size:14px;}
}
</style>
</head>

<body>

<div class="container-1">
  <i class="fa-solid fa-graduation-cap"></i>
  <h1>Sign in to your account</h1>
  <h2>Welcome Back!</h2>
</div>

<div class="login-container">
<form action="login" method="post">

  <div class="form-group">
    <label for="username">Email Address</label>
    <input type="text" id="username" name="username" required />
  </div>

  <div class="form-group">
    <label for="password">Password</label>
    <input type="password" id="password" name="password" required />
  </div>

  <button type="submit">Log In</button>

  <div id="a">
    <div id="b"></div>
    <div id="c"><p>or</p></div>
    <div id="d"></div>
  </div>

  <div id="g_id_signin"></div>

</form>
</div>

</body>
</html>

<script>
function handleCredentialResponse(response) {
  const userObject = parseJwt(response.credential);
  const email = userObject.email;
  sessionStorage.setItem('userEmail', email);

  if(email.endsWith('@bitsathy.ac.in')){
    window.location.href = 'student_dashboard.html';
  } 
  else if(email==='dharineeshv18@gmail.com') {
    window.location.href = 'admin_dashboard.html';
  }
  else{
    window.location.href = 'teacher_dashboard.html';
  }
}

function parseJwt(token) {
  let base64Url = token.split('.')[1];
  let base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
  let jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
  }).join(''));
  return JSON.parse(jsonPayload);
}

window.onload = function () {
  google.accounts.id.initialize({
    client_id: '565558628312-4qtdj4fiqkdalgvbg1k1brkqko64954i.apps.googleusercontent.com',
    callback: handleCredentialResponse,
  });

  google.accounts.id.renderButton(
    document.getElementById('g_id_signin'),
    {
      theme: 'outline',
      size: 'large',
      type: 'standard',
      shape: 'rectangular',
      logo_alignment: 'left',
    }
  );
};
</script>
